/* ui/style.css - 终极修复版 (v4) */

/* --- 1. 基础动画与变量定义 --- */
@keyframes rainbow-move {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

:root {
    /* 默认变量 (会被 Python 动态注入覆盖) */
    --bg-color: #fdfbf7;
    --sidebar-bg: #f2e6d9;
    --text-color: #4a4a4a;
    --accent-color: #8c7b75;
    --input-bg: #f2e6d9;
    --font-family: 'Google Sans', sans-serif;
}

/* --- 2. 核心容器与背景修复 --- */

/* 2.1 全局背景 */
.stApp {
    background-color: var(--bg-color) !important;
}

/* 2.2 顶部 Header (彻底去色) */
header[data-testid="stHeader"] {
    background: transparent !important;
    border-bottom: none !important;
}

/* 2.3 底部输入区容器 (彻底修复黑条) */
/* 这里的关键是把 background 简写属性重置，并覆盖所有层级 */
div[data-testid="stBottom"] {
    background: var(--bg-color) !important; 
    background-color: var(--bg-color) !important;
    border-top: none !important;
}
div[data-testid="stBottom"] > div {
    background: var(--bg-color) !important; 
}

/* 2.4 侧边栏 */
section[data-testid="stSidebar"] {
    background-color: var(--sidebar-bg) !important;
    border-right: 1px solid rgba(128,128,128, 0.1);
}

/* 2.5 全局文字 */
.stMarkdown, h1, h2, h3, h4, h5, h6, p, li, label, span, div, small {
    color: var(--text-color) !important;
    font-family: var(--font-family) !important;
}

/* --- 3. 按钮样式 (自适应主题色 + 加深) --- */

/* 3.1 侧边栏按钮 */
section[data-testid="stSidebar"] .stButton button {
    width: 100% !important;
    text-align: left !important;
    justify-content: flex-start !important;
    padding-left: 1rem !important;
    background-color: rgba(0, 0, 0, 0.05) !important; /* 基础加深 */
    border: 1px solid rgba(0,0,0,0.05) !important;
    color: var(--text-color) !important;
    border-radius: 8px;
    margin-bottom: 4px;
}
section[data-testid="stSidebar"] .stButton button:hover {
    background-color: var(--accent-color) !important;
    color: white !important;
}

/* 3.2 主区域按钮 (修复黑色按钮问题) */
/* 包含普通按钮和 Primary 按钮(如保存/登录) */
.main .stButton button {
    /* 核心逻辑：使用侧边栏颜色作为基底，然后通过滤镜变暗，实现"加深"效果 */
    background-color: var(--sidebar-bg) !important; 
    filter: brightness(0.95); /* 比背景暗 5% */
    color: var(--text-color) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-radius: 8px;
    box-shadow: none !important;
    transition: all 0.2s;
}

.main .stButton button:hover {
    /* Hover 时使用强调色 */
    background-color: var(--accent-color) !important;
    filter: brightness(1); /* 恢复亮度 */
    color: white !important;
    transform: translateY(-1px);
}

/* --- 4. 侧边栏折叠箭头修复 (精准定位) --- */

/* 4.1 隐藏默认的 SVG 图标 */
button[data-testid="stSidebarCollapseButton"] svg,
button[data-testid="stSidebarExpandButton"] svg {
    display: none !important;
}

/* 4.2 侧边栏展开时 (Sidebar右上角)：显示向左箭头 */
button[data-testid="stSidebarCollapseButton"]::after {
    content: "←";  /* 向左箭头 */
    font-size: 24px;
    font-weight: bold;
    color: var(--text-color) !important;
}

/* 4.3 侧边栏折叠时 (ChatPage左上角)：显示向右箭头或菜单 */
button[data-testid="stSidebarExpandButton"]::after {
    content: "→";  /* 向右箭头，提示展开 */
    font-size: 24px;
    font-weight: bold;
    color: var(--text-color) !important;
}

/* 确保箭头按钮本身背景透明，去除边框 */
button[data-testid="stSidebarCollapseButton"],
button[data-testid="stSidebarExpandButton"] {
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
}


/* --- 5. 输入框体系美化 --- */

/* Chat 输入框 */
div[data-testid="stChatInput"] textarea {
    background-color: rgba(255,255,255,0.3) !important; /* 微微透白，增加层次感 */
    color: var(--text-color) !important;
    border: 1px solid rgba(128, 128, 128, 0.3) !important;
    border-radius: 24px !important;
}
/* 去除 ChatInput 外部容器可能存在的背景 */
div[data-testid="stChatInput"] {
    background-color: transparent !important;
}

/* 普通文本框 (Bio, Login) */
div[data-testid="stTextInput"] input,
div[data-testid="stTextArea"] textarea {
    background-color: var(--sidebar-bg) !important; /* 与侧边栏同色 */
    color: var(--text-color) !important;
    border: 1px solid rgba(128, 128, 128, 0.2) !important;
    border-radius: 12px !important;
}


/* --- 6. 其他组件 --- */

/* Radio 按钮 (选项卡) */
div[row-widget="radio"] div[role="radiogroup"] > label {
    background-color: var(--sidebar-bg) !important;
    border: 1px solid rgba(128,128,128,0.1);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    margin-right: 8px;
}
div[row-widget="radio"] div[role="radiogroup"] > label[data-checked="true"] {
    background-color: var(--accent-color) !important;
    color: white !important;
    border-color: transparent;
}
div[row-widget="radio"] div[role="radiogroup"] p {
    font-weight: 500;
}

/* 文件上传框 */
div[data-testid="stFileUploader"] section {
    background-color: var(--sidebar-bg) !important;
    border: 1px dashed var(--accent-color) !important;
}
div[data-testid="stFileUploader"] section span,
div[data-testid="stFileUploader"] section small {
    color: var(--text-color) !important;
}

/* 提示框 (Info/Alert) */
div[data-testid="stAlert"] {
    background-color: var(--sidebar-bg) !important;
    color: var(--text-color) !important;
    border: none !important;
}
div[data-testid="stAlert"] svg {
    fill: var(--text-color) !important;
}

/* 强制清除浏览器默认样式 */
input, textarea, select { color-scheme: normal !important; }